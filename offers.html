<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Offers - Swift Loan Limited</title>
    <link rel="icon" type="image/png" href="swiftloan-logo.png">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-orange: #FF6B00;
            --primary-blue: #001F5C;
            --light-gray: #F5F5F5;
            --text-dark: #333;
            --white: #FFFFFF;
            --success-green: #28a745;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow-x: hidden;
            color: var(--text-dark);
            background: var(--light-gray);
        }

        /* Header */
        header {
            background: var(--white);
            padding: 1rem 5%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-img {
            width: 60px;
            height: 60px;
            object-fit: contain;
        }

        .logo-text-container {
            display: flex;
            flex-direction: column;
        }

        .logo-main {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-blue);
        }

        .logo-main span {
            color: var(--primary-orange);
        }

        .logo-tagline {
            font-size: 0.65rem;
            color: var(--primary-orange);
            letter-spacing: 1px;
        }

        .hamburger {
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding: 10px;
        }

        .hamburger span {
            width: 30px;
            height: 3px;
            background: var(--primary-blue);
            border-radius: 3px;
            transition: 0.3s;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            right: -100%;
            width: 300px;
            height: 100vh;
            background: var(--primary-blue);
            box-shadow: -5px 0 15px rgba(0,0,0,0.3);
            transition: right 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 1000;
            overflow-y: auto;
        }

        .sidebar.active {
            right: 0;
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            background: rgba(255,107,0,0.1);
            border-bottom: 2px solid var(--primary-orange);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--white);
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--white);
            font-size: 2rem;
            cursor: pointer;
        }

        .sidebar-menu {
            list-style: none;
            padding: 2rem 0;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 1rem 1.5rem;
            color: var(--white);
            text-decoration: none;
            transition: 0.3s;
        }

        .sidebar-menu a:hover {
            background: rgba(255,107,0,0.2);
            padding-left: 2rem;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            opacity: 0;
            visibility: hidden;
            transition: 0.3s;
            z-index: 99;
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Main Container */
        .main-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .page-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .page-title {
            color: var(--primary-blue);
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
        }

        .page-description {
            color: #666;
        }

        /* Applicant Details */
        .details-box {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .details-box h3 {
            color: var(--primary-blue);
            margin-bottom: 1rem;
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }

        .detail-item {
            padding: 0.8rem;
            background: var(--light-gray);
            border-radius: 5px;
        }

        .detail-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 0.3rem;
        }

        .detail-value {
            font-weight: 600;
            color: var(--text-dark);
        }

        /* Loan Offers */
        .offers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .offer-card {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: 0.3s;
            animation: slideUp 0.5s ease;
            position: relative;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .offer-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .offer-badge {
            position: absolute;
            top: -10px;
            right: 20px;
            background: var(--primary-orange);
            color: var(--white);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
        }

        .offer-card h3 {
            color: var(--primary-blue);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }

        .offer-details {
            margin-bottom: 1.5rem;
        }

        .offer-row {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 0;
            border-bottom: 1px solid #eee;
        }

        .offer-row:last-child {
            border-bottom: none;
        }

        .offer-label {
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .offer-value {
            font-weight: 600;
            color: var(--text-dark);
        }

        .info-icon {
            color: var(--primary-orange);
            cursor: help;
            font-weight: bold;
        }

        .btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-select {
            background: var(--primary-orange);
            color: var(--white);
        }

        .btn-select:hover {
            background: #e65f00;
            transform: translateY(-2px);
        }

        /* Pie Chart */
        .chart-container {
            margin: 1.5rem 0;
            padding: 1rem;
            background: var(--light-gray);
            border-radius: 8px;
            text-align: center;
        }

        .pie-chart {
            width: 150px;
            height: 150px;
            margin: 0 auto;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--white);
            padding: 2.5rem;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            color: var(--primary-blue);
            font-size: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #666;
        }

        .confirmation-details {
            background: var(--light-gray);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        .confirmation-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px solid #ddd;
        }

        .confirmation-row:last-child {
            border-bottom: none;
        }

        .checkbox-container {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 1.5rem;
        }

        .checkbox-container input[type="checkbox"] {
            margin-top: 3px;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn-confirm {
            background: var(--success-green);
            color: var(--white);
        }

        .btn-cancel {
            background: #6c757d;
            color: var(--white);
        }

        /* Processing Modal */
        .processing-container {
            text-align: center;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255,107,0,0.2);
            border-top-color: var(--primary-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: var(--primary-blue);
            color: var(--white);
            padding: 2rem 5% 1rem;
            margin-top: 3rem;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
            text-align: left;
        }

        .footer-section h3 {
            margin-bottom: 1rem;
            color: var(--primary-orange);
        }

        .footer-links {
            list-style: none;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: var(--white);
            text-decoration: none;
            transition: 0.3s;
        }

        .footer-links a:hover {
            color: var(--primary-orange);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .logo-main {
                font-size: 1.4rem;
            }

            .offers-grid {
                grid-template-columns: 1fr;
            }

            .modal-buttons {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo-section">
                <img src="swiftloan-logo.png" alt="Swift Loan Limited Logo" class="logo-img">
                <div class="logo-text-container">
                    <div class="logo-main">Swift <span>Loan</span> Limited</div>
                    <div class="logo-tagline">EMPOWERING BUSINESS THROUGH FINANCE</div>
                </div>
            </div>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>

    <!-- Sidebar Menu -->
    <div class="overlay" id="overlay"></div>
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">Menu</div>
            <button class="close-btn" id="closeSidebar">&times;</button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="index.html">Home</a></li>
            <li><a href="index.html#about">About Us</a></li>
            <li><a href="index.html#calculator">Loan Calculator</a></li>
            <li><a href="eligibility.html">Apply for Loan</a></li>
            <li><a href="index.html#faq">FAQs</a></li>
            <li><a href="index.html#contact">Contact Us</a></li>
        </ul>
    </aside>

    <!-- Main Container -->
    <div class="main-container">
        <div class="page-header">
            <h1 class="page-title">Your Loan Offers</h1>
            <p class="page-description">Select the loan offer that best suits your needs</p>
        </div>

        <!-- Applicant Details -->
        <div class="details-box">
            <h3>Applicant Details</h3>
            <div class="details-grid" id="applicantDetails">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>

        <!-- Loan Offers Grid -->
        <div class="offers-grid" id="offersGrid">
            <!-- Will be populated by JavaScript -->
        </div>
    </div>

    <!-- Fee Explanation Modal -->
    <div class="modal" id="feeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Why Processing Fee?</h3>
                <button class="close-modal" onclick="closeFeeModal()">&times;</button>
            </div>
            <p style="line-height: 1.8; color: #666;">
                The processing fee covers administrative costs and ensures the security of your loan funds. Your loan amount is held securely by Chase Bank Limited, regulated by the Central Bank of Kenya (CBK).
                <br><br>
                <strong>What the fee covers:</strong>
            </p>
            <ul style="margin: 1rem 0; padding-left: 2rem; color: #666; line-height: 2;">
                <li>Credit verification and assessment</li>
                <li>Secure fund storage with Chase Bank</li>
                <li>Document processing and verification</li>
                <li>Bank-grade 256-bit encryption security</li>
                <li>Instant fund disbursement to your account</li>
            </ul>
            <p style="line-height: 1.8; color: #666;">
                Once the fee is paid, your loan funds are immediately released from Chase Bank to your chosen withdrawal method (M-Pesa, Airtel Money, or Bank Transfer).
            </p>
            <button class="btn btn-select" onclick="closeFeeModal()">I Understand</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirmationModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Your Loan Selection</h3>
                <button class="close-modal" onclick="closeConfirmationModal()">&times;</button>
            </div>
            
            <div class="confirmation-details" id="confirmationDetails">
                <!-- Will be populated by JavaScript -->
            </div>

            <div class="checkbox-container">
                <input type="checkbox" id="confirmCheckbox">
                <label for="confirmCheckbox">I confirm that I have reviewed all loan details and agree to proceed with this loan offer.</label>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-cancel" onclick="closeConfirmationModal()">Cancel</button>
                <button class="btn btn-confirm" onclick="confirmLoanSelection()">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Processing Modal -->
    <div class="modal" id="processingModal">
        <div class="modal-content">
            <div class="processing-container">
                <div class="spinner"></div>
                <h3>Validating...</h3>
                <p style="color: #666; margin-top: 1rem;">Please wait while we process your selection</p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="index.html#about">About Us</a></li>
                        <li><a href="eligibility.html">Apply for Loan</a></li>
                        <li><a href="index.html#faq">FAQs</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contact Information</h3>
                    <p>Email: info@swiftloan.ke</p>
                    <p>Phone: 0732202740</p>
                    <p>WhatsApp: 0732202740</p>
                </div>
            </div>
            <p>&copy; 2025 Swift Loan Limited. All rights reserved. Licensed by Central Bank of Kenya.</p>
        </div>
    </footer>

    <script>
        // Sidebar Toggle
        const hamburger = document.getElementById('hamburger');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const closeSidebarBtn = document.getElementById('closeSidebar');

        function toggleSidebar() {
            hamburger.classList.toggle('active');
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        hamburger.addEventListener('click', toggleSidebar);
        closeSidebarBtn.addEventListener('click', toggleSidebar);
        overlay.addEventListener('click', toggleSidebar);

        let selectedOffer = null;

        // Load and display applicant details
        window.addEventListener('load', function() {
            const personalDetails = localStorage.getItem('swiftloan_personal_details');
            const otherDetails = localStorage.getItem('swiftloan_other_details');
            
            if (!personalDetails || !otherDetails) {
                alert('No application data found. Please complete the application first.');
                window.location.href = 'eligibility.html';
                return;
            }

            const personal = JSON.parse(personalDetails);
            const other = JSON.parse(otherDetails);

            // Display applicant details
            const detailsHTML = `
                <div class="detail-item">
                    <div class="detail-label">Full Name</div>
                    <div class="detail-value">${personal.fullName}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">ID Number</div>
                    <div class="detail-value">${personal.nationalId}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Phone Number</div>
                    <div class="detail-value">${personal.phoneNumber}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">Monthly Income</div>
                    <div class="detail-value">KSh ${other.monthlyIncome}</div>
                </div>
            `;
            
            document.getElementById('applicantDetails').innerHTML = detailsHTML;

            // Generate loan offers
            generateLoanOffers(other);
        });

        function generateLoanOffers(otherDetails) {
            const requestedAmount = parseInt(otherDetails.loanAmount);
            const monthlyIncome = otherDetails.monthlyIncome;
            const repaymentPeriod = parseInt(otherDetails.repaymentPeriod);
            
            // Calculate income range
            const incomeMin = parseInt(monthlyIncome.split('-')[0].replace(/\D/g, ''));
            
            // Generate 3 loan offers based on requested amount
            const offers = [];
            
            // Offer 1: Requested amount
            offers.push(generateOffer(requestedAmount, repaymentPeriod, 'Requested'));
            
            // Offer 2: 50% more (if within limits)
            const higherAmount = Math.min(requestedAmount * 1.5, 100000);
            if (higherAmount > requestedAmount) {
                offers.push(generateOffer(higherAmount, repaymentPeriod, 'Premium'));
            }
            
            // Offer 3: Lower amount
            const lowerAmount = Math.max(requestedAmount * 0.7, 7000);
            if (lowerAmount < requestedAmount) {
                offers.push(generateOffer(lowerAmount, repaymentPeriod, 'Starter'));
            }

            displayOffers(offers);
        }

        function generateOffer(principal, period, type) {
            const monthlyRate = 0.0199; // 1.99%
            const fee = Math.round(principal * 0.02);
            const amountReceived = principal - fee;
            const totalRepayment = Math.round(principal * (1 + (monthlyRate * period)));
            const monthlyPayment = Math.round(totalRepayment / period);
            
            return {
                type: type,
                principal: principal,
                fee: fee,
                amountReceived: amountReceived,
                monthlyRate: 1.99,
                period: period,
                totalRepayment: totalRepayment,
                monthlyPayment: monthlyPayment
            };
        }

        function displayOffers(offers) {
            const offersHTML = offers.map((offer, index) => `
                <div class="offer-card" style="animation-delay: ${index * 0.1}s;">
                    ${index === 0 ? '<div class="offer-badge">Recommended</div>' : ''}
                    <h3>KSh ${offer.principal.toLocaleString()}</h3>
                    
                    <div class="offer-details">
                        <div class="offer-row">
                            <span class="offer-label">Loan Amount:</span>
                            <span class="offer-value">KSh ${offer.principal.toLocaleString()}</span>
                        </div>
                        <div class="offer-row">
                            <span class="offer-label">
                                Processing Fee: 
                                <span class="info-icon" onclick="showFeeModal()">ℹ️</span>
                            </span>
                            <span class="offer-value">KSh ${offer.fee.toLocaleString()}</span>
                        </div>
                        <div class="offer-row">
                            <span class="offer-label">Monthly Rate:</span>
                            <span class="offer-value">${offer.monthlyRate}%</span>
                        </div>
                        <div class="offer-row">
                            <span class="offer-label">Repayment Period:</span>
                            <span class="offer-value">${offer.period} month(s)</span>
                        </div>
                        <div class="offer-row">
                            <span class="offer-label">You'll Receive:</span>
                            <span class="offer-value" style="color: var(--success-green);">KSh ${offer.amountReceived.toLocaleString()}</span>
                        </div>
                        <div class="offer-row">
                            <span class="offer-label">Monthly Payment:</span>
                            <span class="offer-value">KSh ${offer.monthlyPayment.toLocaleString()}</span>
                        </div>
                    </div>

                    <div class="chart-container">
                        <svg class="pie-chart" viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="40" fill="transparent" stroke="#e0e0e0" stroke-width="20"/>
                            <circle cx="50" cy="50" r="40" fill="transparent" stroke="var(--primary-orange)" stroke-width="20"
                                stroke-dasharray="${(offer.amountReceived / offer.principal) * 251.2} 251.2"
                                transform="rotate(-90 50 50)"/>
                            <text x="50" y="55" text-anchor="middle" font-size="14" font-weight="bold" fill="var(--primary-blue)">
                                ${Math.round((offer.amountReceived / offer.principal) * 100)}%
                            </text>
                        </svg>
                        <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #666;">Amount to Receive</p>
                    </div>

                    <button class="btn btn-select" onclick='selectOffer(${JSON.stringify(offer)})'>
                        Select This Loan Offer
                    </button>
                </div>
            `).join('');
            
            document.getElementById('offersGrid').innerHTML = offersHTML;
        }

        function showFeeModal() {
            document.getElementById('feeModal').classList.add('active');
        }

        function closeFeeModal() {
            document.getElementById('feeModal').classList.remove('active');
        }

        function selectOffer(offer) {
            selectedOffer = offer;
            
            const confirmHTML = `
                <div class="confirmation-row">
                    <strong>Loan Amount:</strong>
                    <strong>KSh ${offer.principal.toLocaleString()}</strong>
                </div>
                <div class="confirmation-row">
                    <span>Processing Fee:</span>
                    <span>KSh ${offer.fee.toLocaleString()}</span>
                </div>
                <div class="confirmation-row">
                    <span>You'll Receive:</span>
                    <span style="color: var(--success-green);">KSh ${offer.amountReceived.toLocaleString()}</span>
                </div>
                <div class="confirmation-row">
                    <span>Monthly Rate:</span>
                    <span>${offer.monthlyRate}%</span>
                </div>
                <div class="confirmation-row">
                    <span>Repayment Period:</span>
                    <span>${offer.period} month(s)</span>
                </div>
                <div class="confirmation-row">
                    <strong>Total Repayment:</strong>
                    <strong>KSh ${offer.totalRepayment.toLocaleString()}</strong>
                </div>
                <div class="confirmation-row">
                    <strong>Monthly Payment:</strong>
                    <strong>KSh ${offer.monthlyPayment.toLocaleString()}</strong>
                </div>
            `;
            
            document.getElementById('confirmationDetails').innerHTML = confirmHTML;
            document.getElementById('confirmationModal').classList.add('active');
        }

        function closeConfirmationModal() {
            document.getElementById('confirmationModal').classList.remove('active');
            document.getElementById('confirmCheckbox').checked = false;
        }

        function confirmLoanSelection() {
            if (!document.getElementById('confirmCheckbox').checked) {
                alert('Please confirm that you agree to proceed');
                return;
            }
            
            // Save selected offer to localStorage
            localStorage.setItem('swiftloan_selected_offer', JSON.stringify(selectedOffer));
            
            // Generate unique loan ID
            const loanId = 'LN-' + Math.floor(10000 + Math.random() * 90000);
            localStorage.setItem('swiftloan_loan_id', loanId);
            
            // Show processing modal
            document.getElementById('confirmationModal').classList.remove('active');
            document.getElementById('processingModal').classList.add('active');
            
            // Redirect after 7 seconds
            setTimeout(() => {
                window.location.href = 'loan-withdrawal.html';
            }, 7000);
        }
    </script>
</body>
</html>
